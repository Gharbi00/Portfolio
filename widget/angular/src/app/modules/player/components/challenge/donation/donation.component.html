<div [class.dark-mode]="darkMode" [class.rtl]="rtl">
  <div class="quests content-grid col-md-12 header-margin">
    <div class="section-banner"
      [ngStyle]="{ background: 'url(' + headerImagePath + ') no-repeat center center / cover' }">
      <img class="section-banner-icon" [src]="rocketIcon?.baseUrl + '/' + rocketIcon?.path" alt="newsfeed-icon" />
      <p class="section-banner-title">{{'DONATION' | translate}}</p>
      <p class="section-banner-text text-truncate">{{'COMPLETE_DONATION' | translate}}</p>
    </div>
  </div>

  <div [ngStyle]="{'margin-bottom': challenge?.winners?.length ? '16px' : '90px'}" class="col-md-12 special-margin">
    <div class="product-preview">
      <a>
        <figure class="product-preview-image liquid" [ngStyle]="{
              'background-image': 'url(' + defaultChallengeImage + ')',
              'background-position': 'center',
              'background-size': 'cover'
            }">
          <img src="img/marketplace/items/01.jpg" alt="item-01" style="display: none" />
        </figure>
      </a>

      <div class="product-preview-info">
        <div>
          <h4>
            {{challenge?.donation?.donation?.donation?.cause?.title}}
          </h4>
          <p style="line-height: normal">
            {{challenge?.donation?.donation?.donation?.cause?.description}}
          </p>
        </div>
        <p style="gap: 0.5rem;"
          class="align-items-center d-flex mb-3 product-preview-text justify-content-between col-lg-12">
          <a [ngClass]="{'text-white': darkMode, 'text-black': !darkMode}"
            style="font-size: 17px !important; font-weight: 600"> {{'BALANCE' | translate}} </a>
          <span class="align-items-center d-flex product-preview-title">
            <span [ngClass]="{'text-white': darkMode, 'text-black': !darkMode}" style="font-size: 24px;">
              {{quantitativeWallet?.[0]?.amount || 0}}
            </span>
            <img
              *ngIf="(loyaltySettings$ | async)?.referral?.remuneration?.referrer?.quantitative?.wallet?.coin?.picture?.baseUrl"
              [src]="(loyaltySettings$ | async)?.referral?.remuneration?.referrer?.quantitative?.wallet?.coin?.picture?.baseUrl + '/' + (loyaltySettings$ | async)?.referral?.remuneration?.referrer?.quantitative?.wallet?.coin?.picture?.path"
              class="assets/img-fluid rounded-circle avatar-xxs ml-1" style="width: 30px !important" />
            <lord-icon
              *ngIf="!(loyaltySettings$ | async)?.referral?.remuneration?.referrer?.quantitative?.wallet?.coin?.picture?.baseUrl"
              src="https://cdn.lordicon.com/lxizbtuq.json" class="ml-1" trigger="loop" delay="2000"
              style="width:30px;height:30px">
            </lord-icon>
          </span>
        </p>
        <div class="align-content-center col-lg-12 d-flex justify-content-between">
          <p class="align-content-center col-lg-4 p-0">
            <a [ngClass]="{'text-white': darkMode, 'text-black': !darkMode}"
              style="font-size: 17px !important; font-weight: 600"> {{'AMMOUNT_TO_DONATE' | translate}} </a>
          </p>
          <div class="interactive-input col-lg-4 p-0">
            <input [formControl]="walletAmount" class="text-input no-spinner" type="number" id="search-main"
              name="search_main" placeholder="0">
            <div class="interactive-input-icon-wrap">
              <div class="interactive-input-icon icon-magnifying-glass">
                <img
                  *ngIf="(loyaltySettings$ | async)?.referral?.remuneration?.referrer?.quantitative?.wallet?.coin?.picture?.baseUrl"
                  [src]="(loyaltySettings$ | async)?.referral?.remuneration?.referrer?.quantitative?.wallet?.coin?.picture?.baseUrl + '/' + (loyaltySettings$ | async)?.referral?.remuneration?.referrer?.quantitative?.wallet?.coin?.picture?.path"
                  class="assets/img-fluid rounded-circle avatar-xxs ml-1" style="width: 25px !important" />
                <lord-icon
                  *ngIf="!(loyaltySettings$ | async)?.referral?.remuneration?.referrer?.quantitative?.wallet?.coin?.picture?.baseUrl"
                  src="https://cdn.lordicon.com/lxizbtuq.json" class="ml-1" trigger="loop" delay="2000"
                  style="width:25px;height:25px">
                </lord-icon>
              </div>
            </div>
          </div>
        </div>
        <p style="gap: 0.5rem"
          class="align-items-center d-flex justify-content-between col-lg-12 mb-1 product-preview-text">
          <span [ngClass]="{'text-white': darkMode, 'text-black': !darkMode}"
            style="font-size: 17px !important; font-weight: 600">
            {{'REMAINING_BALANCE' | translate}}
          </span>
          <span class="align-items-center d-flex product-preview-title">
            <span [ngClass]="{'text-white': darkMode, 'text-black': !darkMode}" style="font-size: 24px;">
              {{remainingAmount > 0 ? remainingAmount : 0}}
            </span>
            <img
              *ngIf="(loyaltySettings$ | async)?.referral?.remuneration?.referrer?.quantitative?.wallet?.coin?.picture?.baseUrl"
              [src]="(loyaltySettings$ | async)?.referral?.remuneration?.referrer?.quantitative?.wallet?.coin?.picture?.baseUrl + '/' + (loyaltySettings$ | async)?.referral?.remuneration?.referrer?.quantitative?.wallet?.coin?.picture?.path"
              class="assets/img-fluid rounded-circle avatar-xxs ml-1" style="width: 30px !important" />
            <lord-icon
              *ngIf="!(loyaltySettings$ | async)?.referral?.remuneration?.referrer?.quantitative?.wallet?.coin?.picture?.baseUrl"
              src="https://cdn.lordicon.com/lxizbtuq.json" class="ml-1" trigger="loop" delay="2000"
              style="width:30px; height:30px">
            </lord-icon>
          </span>
        </p>

        <div *ngIf="calculateDonation() > 0" class="quests section-filters-bar border v2 col-md-12 special-margin">
          <div class="d-flex align-items-center">
            <div>
              <img class="table-image" [src]="starIcon?.baseUrl + '/' + starIcon?.path" width="30" height="30"
                alt="completedq-s" />
              <span style="margin-left: 16px; margin-right: 16px;"> {{'TO_EARN' | translate}} </span>
            </div>
            <div class="experience-design">
              <p style="top: 0px; position: relative; right: 0px;" class="d-flex align-items-center text-sticker">
                <svg class="text-sticker-icon icon-plus-small">
                  <use xlink:href="#svg-plus-small"></use>
                </svg>
                {{ calculateDonation() | number: '1.0-0' }}
                <img *ngIf="!(loyaltySettings$ | async)?.qualitative?.picture?.baseUrl"
                  src="https://sifca-storage.s3.eu-central-1.amazonaws.com/loyalcraft/reputation_512.gif"
                  class="assets/img-fluid rounded-circle ml-1" style=" width: 25px !important" />
                <img *ngIf="(loyaltySettings$ | async)?.qualitative?.picture?.baseUrl"
                  [src]="(loyaltySettings$ | async)?.qualitative?.picture?.baseUrl + '/' + (loyaltySettings$ | async)?.qualitative?.picture?.path"
                  class="assets/img-fluid rounded-circle ml-1" style="width: 25px !important" />
              </p>
            </div>
          </div>
        </div>
        <div [class.mb-5]="!challenge?.winners?.length">
          <div class="d-flex justify-content-end">
            <button (mouseenter)="isHovered = true" (mouseleave)="isHovered = false"
              [disabled]="remainingAmount < 0 || isButtonDisabled || +donatedAmount === 0 || !isSameCoin"
              (click)="perform()"
              [class.white-solid]="remainingAmount < 0 || isButtonDisabled || +donatedAmount === 0 || !isSameCoin"
              [class.primary]="remainingAmount >= 0 && !isButtonDisabled && +donatedAmount > 0 && isSameCoin"
              class="button">{{'CONFIRM' | translate}}</button>
          </div>
          <div class="d-flex justify-content-end mt-3" *ngIf="!isSameCoin && isHovered">
            <p style="font-size: 17.6px; font-weight: 700;" class="text-danger">
              {{'NOT_ELIGIBLE_TO_DONATE' | translate}}
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <ng-container *ngIf="challenge?.winners?.length">
    <app-rewards [winners]="challenge?.winners"></app-rewards>
  </ng-container>

</div>
<svg style="display: none">
  <symbol id="svg-clock" viewBox="0 0 20 20" preserveAspectRatio="xMinYMin meet">
    <path
      d="M10,0C4.486,0,0,4.485,0,9.999c0,5.515,4.486,10,10,10c5.514,0,10-4.485,10-10C20,4.485,15.514,0,10,0zM10,17.999c-4.414,0-8.005-3.589-8.005-8S5.586,2,10,2c4.414,0,8.005,3.588,8.005,7.999S14.414,17.999,10,17.999z M14.437,12.105l-3.44-1.724V4.999C10.997,4.447,10.551,4,10,4S9.002,4.447,9.002,4.999V11c0,0.379,0.213,0.725,0.551,0.894l3.99,2C13.687,13.966,13.838,14,13.988,14c0.367,0,0.719-0.203,0.894-0.554C15.128,12.953,14.929,12.352,14.437,12.105z" />
  </symbol>
</svg>

<svg style="display: none;">
  <symbol id="svg-magnifying-glass" viewBox="0 0 20 20" preserveAspectRatio="xMinYMin meet">
    <path
      d="M8,2c3.309,0,6,2.691,6,6s-2.691,6-6,6s-6-2.691-6-6S4.691,2,8,2 M8,0C3.582,0,0,3.582,0,8c0,4.418,3.582,8,8,8c4.418,0,8-3.582,8-8C16,3.582,12.418,0,8,0L8,0z" />
    <path
      d="M19.171,15.168l-3.134-3.134c-0.309,0.613-0.679,1.19-1.113,1.714l2.833,2.834c0.323,0.324,0.323,0.851,0,1.175C17.545,17.969,17.298,18,17.17,18c-0.129,0-0.376-0.031-0.588-0.243l-2.834-2.833c-0.523,0.435-1.101,0.805-1.714,1.113l3.134,3.134C15.721,19.724,16.445,20,17.169,20c0.725,0,1.449-0.276,2.002-0.829C20.276,18.065,20.276,16.273,19.171,15.168z" />
  </symbol>
</svg>

<svg style="display: none;">
  <symbol id="svg-cross-thin" viewBox="0 0 20 20" preserveAspectRatio="xMinYMin meet">
    <path
      d="M18,16.547L16.545,18L10,11.455L3.455,18L2,16.547L8.545,10L2,3.455L3.455,2L10,8.546L16.545,2L18,3.455L11.455,10L18,16.547z" />
  </symbol>
</svg>

<svg style="display: none">
  <symbol id="svg-plus-small" viewBox="0 0 8 8" preserveAspectRatio="xMinYMin meet">
    <path d="M8,5H5v3H3V5H0V3h3V0h2v3h3V5z" />
  </symbol>
</svg>
